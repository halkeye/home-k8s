app-template:
  controllers:
    main:
      type: cronjob
      revisionHistoryLimit: 1
      annotations:
        reloader.stakater.com/auto: 'true'
      cronjob:
        schedule: "0 */12 * * *"
        ttlSecondsAfterFinished: 86400
        successfulJobsHistory: 3
        failedJobsHistory: 2
      containers:
        zap2xml:
          image:
            repository: shuaiscott/zap2xml
            tag: latest@sha256:ffcb45211ac8f2eeaa7e7b323625d6261ee8e223e0169f082cd2101a9b77317f
          command:
            - "/bin/sh"
            - "-c"
            - "cat /zap2xml.pl | sed 's/tvlistings.zap2it.com/tvschedule.zap2it.com/g' | perl - -u $USERNAME -p $PASSWORD -U -o /data/$XMLTV_FILENAME $OPT_ARGS"
          env:
            TZ: America/Vancouver
            OPT_ARGS: '-I -D -c /data/cache'
          envFrom:
            - secretRef:
                name: '{{.Release.Name}}-secret'
  persistence:
    data:
      enabled: true
      type: nfs
      server: 172.16.10.10
      path: "/volume1/Apps/zap2xml"
