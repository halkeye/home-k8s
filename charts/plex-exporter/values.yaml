fullnameOverride: plex-exporter
app-template:
  fullnameOverride: plex-exporter
  controllers:
    main:
      type: statefulset
      strategy: RollingUpdate
      containers:
        main:
          image:
            repository: "ghcr.io/jsclayton/prometheus-plex-exporter"
            tag: "latest@sha256:ebb7c4cb360ab430b3db5011e4e35c8fbff60d5b32510c6f5d2fbd5a581b4511"
          envFrom:
            - secretRef:
                name: "{{.Release.Name}}-secret"
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 100m
              memory: 100Mi
            limits:
              cpu: 100m
              memory: 100Mi
      pod:
        securityContext:
          runAsUser: 100
          runAsGroup: 100
          runAsNonRoot: true
          fsGroup: 100
          fsGroupChangePolicy: OnRootMismatch
  service:
    main:
      controller: main
      ports:
        http:
          port: 9000
  serviceMonitor:
    main:
      enabled: true
      serviceName: main
      endpoints:
        - port: http
          scheme: http
          path: /metrics
