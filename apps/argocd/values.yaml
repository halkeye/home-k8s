argo-cd:
  server:
    ingress:
      enabled: true
      ingressClassName: nginx
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
        nginx.ingress.kubernetes.io/ssl-passthrough: "true"
        hajimari.io/appName: "ArgoCD"
        hajimari.io/icon: "robot"
      hosts:
        - &host argocd.home.g4v.dev
      tls:
        - secretName: argocd-tls-certificate
          hosts:
            - *host
  configs:
    repositories:
      github:
        url: https://github.com/halkeye/home-k8s
        name: halkeye-home-k8s

    rbac:
      policy.csv: g, ArgoCD Admins, role:admin
      policy.default: role:readonly
    cm:
      exec.enabled: true
      admin.enabled: "false"
      helm.valuesFileSchemes: secrets+gpg-import, secrets+gpg-import-kubernetes, secrets+age-import,
        secrets+age-import-kubernetes, secrets,secrets+literal, https
      kustomize.buildOptions: --enable-alpha-plugins --enable-exec
      url: https://argocd.home.g4v.dev
      dex.config: |
        connectors:
          # OIDC
          - type: oidc
            id: Auth
            name: Auth
            config:
              issuer: https://auth.g4v.dev/application/o/argocd/
              clientID: zP5xeL7aYlacy7HSN9c7q63k964G47nz0cPEN3mW
              clientSecret: $oidc.authentik.clientSecret
              allowedAudiences:
                - zP5xeL7aYlacy7HSN9c7q63k964G47nz0cPEN3mW
                - argo-cd-cli
                - argo-cd
              insecureEnableGroups: true
              scopes:
                - openid
                - profile
                - email
                - groups
